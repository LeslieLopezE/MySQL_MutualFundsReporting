USE MutualFunds;

DROP TABLE IF EXISTS acct_month_blnce;

CREATE TABLE MutualFunds.acct_month_blnce (
    Acct_no      INT             NOT NULL,
    Holdng_no    INT             NOT NULL,
    Orig_Branch	 INT      		 NOT NULL,
    Instrm_na	 VARCHAR(20)     	NOT NULL,
    Prin_amt	 NUMERIC(16,2)		NOT NULL,
    Book_value	 NUMERIC(16,2)		NOT NULL,
    Currency	 VARCHAR(3)         NOT NULL,	
    Posted_date   DATE          NOT NULL,
    --  FOREIGN KEY (Acct_no) REFERENCES Cust_Acct (Acct_no) ON DELETE CASCADE,
    PRIMARY KEY (Acct_no,Holdng_no,Posted_date)
) 
; 

INSERT acct_month_blnce VALUES (88890,1918171611,1120,'IndexMF_A',234000,200999,'CAD','2021-04-30'),
(88890,1918171612,1120,'IndexMF_B',250000,200999,'CAD','2022-10-31'),
(88891,1918171611,1456,'IndexMF_A',100,12000,'CAD','2020-05-30'),
(88892,1918171612,9999,'IndexMF_B',20000,19000,'CAD','2022-03-30'),
(88893,1918171613,1243,'IndexMF_C',100000,85000,'CAD','2021-06-30'),
(88894,1918171611,1456,'IndexMF_A',80500,68425,'CAD','2020-02-28'),
(88894,1918171612,4093,'IndexMF_B',200600,170510,'CAD','2020-01-30'),
(88894,1918171613,4093,'IndexMF_C',10000,8500,'CAD','2022-10-31'),
(88895,1918171614,1678,'IndexMF_D',700000,595000,'CAD','2022-10-31'),
(88896,1918171611,2578,'IndexMF_A',89000,75650,'CAD','2022-10-31'),
(88890,1918171611,1120,'IndexMF_A',199999,200999,'CAD','2022-09-30'),
(88890,1918171612,1120,'IndexMF_B',201666,200999,'CAD','2022-09-30'),
(88891,1918171611,1456,'IndexMF_A',80,12000,'CAD','2022-10-31'),
(88892,1918171612,9999,'IndexMF_B',25000,19000,'CAD','2022-10-31'),
(88893,1918171613,1243,'IndexMF_C',91000,91000,'CAD','2022-10-31'),
(88894,1918171611,1456,'IndexMF_A',80500,68425,'CAD','2022-10-31'),
(88894,1918171612,4093,'IndexMF_B',200600,170510,'CAD','2022-10-31'),
(88897,1918171615,6889,'MoneyMkt_CAN',420750,382500,'CAD','2022-10-31'),
(88898,1918171616,8890,'MoneyMktMF_W',46750,42500,'CAD','2022-10-31'),
(88899,1918171617,4396,'MoneyMktMF_US',83215,75650,'CAD','2022-10-31'),
(88900,1918171615,4397,'MoneyMkt_CAN',1122,1020,'CAD','2022-10-31'),
(88901,1918171616,4398,'MoneyMktMF_W',4207.5,3825,'CAD','2022-10-31'),
(88902,1918171617,1345,'MoneyMktMF_US',4270.1,3882,'CAD','2022-10-31'),
(88903,1918171618,1569,'LongTermMF_CAN',45678,37456,'CAD','2022-10-31'),
(88904,1918171619,7898,'LongTermMF_US',43567,35724.9,'CAD','2022-10-31'),
(88905,1918171620,3949,'LongTermMF_W',800000,656000,'CAD','2022-10-31'),
(88905,1918171619,3949,'LongTermMF_CAN',88995,72975.9,'CAD','2022-10-31'),
(88906,1918171619,3331,'LongTermMF_US',10005,8204.1,'CAD','2022-10-31'),
(88907,1918171620,9897,'LongTermMF_W',45670,38819.5,'CAD','2022-10-31'),
(88908,1918171612,5678,'IndexMF_B',8767,7452,'CAD','2022-10-31'),
(88909,1918171613,6578,'IndexMF_C',5450,4632.5,'CAD','2022-10-31'),
(88910,1918171611,1243,'IndexMF_A',6800,5780,'CAD','2022-10-31'),
(88911,1918171614,4093,'IndexMF_D',4322,3673.7,'CAD','2022-10-31'),
(88912,1918171615,1678,'MoneyMkt_CAN',1500,1275,'CAD','2022-10-31'),
(88913,1918171616,2578,'MoneyMktMF_W',2664.8,2265,'CAD','2022-10-31'),
(88914,1918171617,6889,'MoneyMktMF_US',2273.9,1932.8,'CAD','2022-10-31'),
(88915,1918171616,8890,'MoneyMktMF_W',7786.4,6618.4,'CAD','2022-10-31'),
(88916,1918171617,4396,'MoneyMktMF_US',2990.7,2542.1,'CAD','2022-10-31'),
(88917,1918171616,4397,'MoneyMktMF_W',1190.3,1011.7,'CAD','2022-10-31'),
(88918,1918171617,4398,'MoneyMktMF_US',7008.3,5957,'CAD','2022-10-31'),
(88919,1918171615,1345,'MoneyMkt_CAN',67989.3,57790.9,'CAD','2022-10-31'),
(88920,1918171618,1569,'LongTermMF_CAN',8900,6230,'CAD','2022-10-31'),
(88921,1918171619,7898,'LongTermMF_US',45678,31974.6,'CAD','2022-10-31'),
(88922,1918171620,3949,'LongTermMF_W',300678,210474.6,'CAD','2022-10-31'),
(88922,1918171618,3949,'LongTermMF_CAN',45000,31500,'CAD','2022-10-31'),
(88923,1918171620,3331,'LongTermMF_W',2367549,1657284.3,'CAD','2022-10-31'),
(88924,1918171618,9897,'LongTermMF_CAN',0,0,'CAD','2022-10-31'),
(88925,1918171619,5678,'LongTermMF_US',0,0,'CAD','2022-10-31'),
(88926,1918171620,6578,'LongTermMF_W',0,	0,'CAD','2022-10-31'),
(88827,1918171620,1456,'LongTermMF_W',10040,10000,'CAD','2021-05-30'),
(88827,1918171620,1456,'LongTermMF_W',10140,10000,'CAD','2022-10-31'),
(88828,1918171620,1456,'LongTermMF_W',5005,5000,'CAD','2022-10-31'),
(88829,1918171618,1456,'LongTermMF_CAN',25025,25000,'CAD','2022-10-31'),
(88830,1918171615,4397,'MoneyMkt_CAN',2500,2400,'CAD','2022-10-31'),
(88831,1918171618,4397,'LongTermMF_CAN',85250,84500,'CAD','2022-10-31'),
(88932,1918171615,3331,'MoneyMkt_CAN',5250,5000,'CAD','2022-10-31');